{"mode":"dev","input_data":"Dec 23 12:11:43 louis postfix/smtpd: connect from unknown[95.75.93.154]\nFeb 22 13:50:40 louis snapd[1727]: udevmon.go:190: udev monitor observed remove event for unknown device \"/sys/mm_struct(7838:phpsessionclean.service)\"\n2018-08-14T14:30:02.203151+02:00 linux-sqrz systemd[4179]: Stopped target Basic System.\n2018-08-14T14:30:02.203251+02:00 linux-sqrz systemd: Stopped target Paths.\nNov 10 10:27:47 Startup finished in 49ms.\n2020-08-14T14:30:02.203251 Reached target Paths.","tdd":"ignore:\n  - message\n  - '@version'\n  - '@timestamp'\n\ntestcases:\n\n  - input:\n      - 'Dec 23 12:11:43 louis postfix/smtpd: connect from unknown[95.75.93.154]'\n    expected:\n      - '[event][kind]': event\n        '[host][hostname]': louis\n        path: /var/log/syslog\n        '[related][hosts]':\n          - louis\n        '[ecs][version]': 1.6.0\n        type: syslog\n        '[process][name]': postfix/smtpd\n        '[system][syslog][message]': 'connect from unknown[95.75.93.154]'\n\n  - input:\n      - 'Feb 22 13:50:40 louis snapd[1727]: udevmon.go:190: udev monitor observed remove event for unknown device \"/sys/mm_struct(7838:phpsessionclean.service)\"'\n    expected:\n      - '[event][kind]': event\n        '[host][hostname]': louis\n        path: /var/log/syslog\n        '[related][hosts]':\n          - louis\n        '[ecs][version]': 1.6.0\n        type: syslog\n        '[process][pid]': 1727\n        '[process][name]': snapd\n        '[system][syslog][message]': 'udevmon.go:190: udev monitor observed remove event for unknown device \"/sys/mm_struct(7838:phpsessionclean.service)\"'\n\n  - input:\n      - '2018-08-14T14:30:02.203151+02:00 linux-sqrz systemd[4179]: Stopped target Basic System.'\n    expected:\n      - '[event][kind]': event\n        '[host][hostname]': linux-sqrz\n        path: /var/log/syslog\n        '[related][hosts]':\n          - linux-sqrz\n        '[ecs][version]': 1.6.0\n        type: syslog\n        '[process][pid]': 4179\n        '[process][name]': systemd\n        '[system][syslog][message]': Stopped target Basic System.\n\n  - input:\n      - '2018-08-14T14:30:02.203251+02:00 linux-sqrz systemd: Stopped target Paths.'\n    expected:\n      - '[event][kind]': event\n        '[host][hostname]': linux-sqrz\n        path: /var/log/syslog\n        '[related][hosts]':\n          - linux-sqrz\n        '[ecs][version]': 1.6.0\n        type: syslog\n        '[process][name]': systemd\n        '[system][syslog][message]': Stopped target Paths.\n\n  - input:\n      - 'Nov 10 10:27:47 Startup finished in 49ms.'\n    expected:\n      - '[event][kind]': event\n        path: /var/log/syslog\n        '[ecs][version]': 1.6.0\n        type: syslog\n        '[system][syslog][message]': Startup finished in 49ms.\n\n  - input:\n      - '2020-08-14T14:30:02.203251 Reached target Paths.'\n    expected:\n      - '[event][kind]': event\n        path: /var/log/syslog\n        '[ecs][version]': 1.6.0\n        type: syslog\n        '[system][syslog][message]': Reached target Paths.\n","logstash_filter":"filter {\n\n  if [type] == \"syslog\" {\n    \n    mutate {\n      add_field => {\n        \"[event][kind]\" => \"event\"\n        \"[ecs][version]\" => \"1.6.0\"\n      }\n      remove_field => [\"host\"]\n    }\n\n    grok {\n      match => {\n        \"message\" => [\n          \"%{TIMESTAMP_ISO8601:[system][syslog][timestamp]} %{SYSLOGHOST:[host][hostname]} %{DATA:[process][name]}(?:\\[%{POSINT:[process][pid]:int}\\])?: %{GREEDYDATA:[system][syslog][message]}\",\n          \"%{SYSLOGTIMESTAMP:[system][syslog][timestamp]} %{SYSLOGHOST:[host][hostname]} %{DATA:[process][name]}(?:\\[%{POSINT:[process][pid]:int}\\])?: %{GREEDYDATA:[system][syslog][message]}\",\n          \"%{TIMESTAMP_ISO8601:[system][syslog][timestamp]} %{GREEDYDATA:[system][syslog][message]}\",\n          \"%{SYSLOGTIMESTAMP:[system][syslog][timestamp]} %{GREEDYDATA:[system][syslog][message]}\"\n        ]\n      }\n    }\n    \n    date {\n      match => [\"[system][syslog][timestamp]\", \"MMM  d HH:mm:ss\", \"MMM dd HH:mm:ss\", \"MMM d HH:mm:ss\", \"ISO8601\"]\n      target => \"@timestamp\"\n      remove_field => [\"[system][syslog][timestamp]\"]\n    }\n    \n    if [host][hostname] {\n      ruby { code => 'event.set(\"[related][hosts]\", [ event.get(\"[host][hostname]\") ])' }\n    }\n\n  }\n\n}","input_fields":[{"attribute":"type","value":"syslog"},{"attribute":"path","value":"/var/log/syslog"}],"custom_logstash_patterns":"","custom_codec":"","filter_regex_enabled":false,"filter_reverse_match_enabled":false,"filter_display":"","number_lines_display":"10"}