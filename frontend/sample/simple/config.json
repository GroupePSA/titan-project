{"mode":"dev","input_data":"Dec 23 12:11:43 louis postfix/smtpd[31499]: connect from unknown[95.75.93.154]\nDec 23 14:42:56 louis named[16000]: client 199.48.164.7#64817: query (cache) 'amsterdamboothuren.com/MX/IN' denied\nDec 23 14:30:01 louis CRON[619]: (www-data) CMD (php /usr/share/cacti/site/poller.php >/dev/null 2>/var/log/cacti/poller-error.log)\nDec 22 18:28:06 louis rsyslogd: [origin software=\"rsyslogd\" swVersion=\"4.2.0\" x-pid=\"2253\" x-info=\"http://www.rsyslog.com\"] rsyslogd was HUPed, type 'lightweight'.\nFeb 23 11:23:46 louis systemd-resolved[1285]: Server returned error NXDOMAIN, mitigating potential DNS violation DVE-2018-0001, retrying transaction with reduced feature level UDP.\nFeb 23 11:32:10 louis tilix[26495]: (../../src/vtegtk.cc:1906):int vte_terminal_match_add_gregex(VteTerminal*, GRegex*, GRegexMatchFlags): runtime check failed: (g_regex_get_compile_flags(gregex) & G_REGEX_MULTILINE)\nFeb 23 11:32:06 louis kernel: [60390.791792] kauditd_printk_skb: 470 callbacks suppressed\nFeb 23 11:17:01 louis CRON[1853]: (root) CMD (   cd / && run-parts --report /etc/cron.hourly)\nFeb 22 13:50:40 louis snapd[1727]: udevmon.go:190: udev monitor observed remove event for unknown device \"/sys/mm_struct(7838:phpsessionclean.service)\"","tdd":"ignore:\n  - \"message\"\ntestcases:\n\n  - description: \"Standard syslog message with PID\"\n    input:\n      - \"Dec 23 12:11:43 louis postfix/smtpd[31499]: connect from unknown[95.75.93.154]\"\n    expected:\n      - host: \"louis\"\n        syslog_message: \"connect from unknown[95.75.93.154]\"\n        pid: 31499\n        program: \"postfix/smtpd\"\n        type: \"syslog\"\n        path: \"/var/log/syslog\"\n        \"@timestamp\": \"2020-12-23T12:11:43.000Z\"\n        \n  - description: \"Standard syslog message with PID and one digit date\"\n    input:\n      - \"Dec  3 12:11:43 louis postfix/smtpd[31499]: connect from unknown[95.75.93.154]\"\n    expected:\n      - host: \"louis\"\n        syslog_message: \"connect from unknown[95.75.93.154]\"\n        pid: 31499\n        program: \"postfix/smtpd\"\n        type: \"syslog\"\n        path: \"/var/log/syslog\"\n        \"@timestamp\": \"2020-12-03T12:11:43.000Z\"\n        \n  - description: \"Standard syslog message without PID\"\n    input:\n      - \"Dec 22 18:28:06 louis rsyslogd: [origin software=\\\"rsyslogd\\\" swVersion=\\\"4.2.0\\\" x-pid=\\\"2253\\\" x-info=\\\"http://www.rsyslog.com\\\"] rsyslogd was HUPed, type 'lightweight'.\"\n    expected:\n      - host: \"louis\"\n        syslog_message: \"[origin software=\\\"rsyslogd\\\" swVersion=\\\"4.2.0\\\" x-pid=\\\"2253\\\" x-info=\\\"http://www.rsyslog.com\\\"] rsyslogd was HUPed, type 'lightweight'.\"\n        program: \"rsyslogd\"\n        type: \"syslog\"\n        path: \"/var/log/syslog\"\n        \"@timestamp\": \"2020-12-22T18:28:06.000Z\"\n        \n  - description: \"Standard syslog message without PID and one digit date\"\n    input:\n      - \"Dec  2 18:28:06 louis rsyslogd: [origin software=\\\"rsyslogd\\\" swVersion=\\\"4.2.0\\\" x-pid=\\\"2253\\\" x-info=\\\"http://www.rsyslog.com\\\"] rsyslogd was HUPed, type 'lightweight'.\"\n    expected:\n      - host: \"louis\"\n        syslog_message: \"[origin software=\\\"rsyslogd\\\" swVersion=\\\"4.2.0\\\" x-pid=\\\"2253\\\" x-info=\\\"http://www.rsyslog.com\\\"] rsyslogd was HUPed, type 'lightweight'.\"\n        program: \"rsyslogd\"\n        type: \"syslog\"\n        path: \"/var/log/syslog\"\n        \"@timestamp\": \"2020-12-02T18:28:06.000Z\"","logstash_filter":"filter {\n\n  if [type] == \"syslog\" {\n\n    grok {\n      match => {\n        \"message\" => \"%{SYSLOGTIMESTAMP:[@metadata][timestamp]} %{SYSLOGHOST:host} %{DATA:program}(?:\\[%{POSINT:pid}\\])?: %{GREEDYDATA:syslog_message}\"\n      }\n      overwrite => [\"host\"]\n    }\n    date {\n      match => [\"[@metadata][timestamp]\", \"MMM  d HH:mm:ss\", \"MMM dd HH:mm:ss\"]\n    }\n\n    if [pid] {\n      mutate {\n        convert => {\n          \"pid\" => \"integer\"\n        }\n      }\n    }\n\n  }\n\n}","input_fields":[{"attribute":"type","value":"syslog"},{"attribute":"path","value":"/var/log/syslog"}],"custom_logstash_patterns":"","custom_codec":"","filter_regex_enabled":false,"filter_reverse_match_enabled":false,"filter_display":"","number_lines_display":"10"}